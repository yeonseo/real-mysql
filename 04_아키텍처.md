## 04. 아키텍처
<br><br>

### 4.1 MySQL 엔진 아키텍처

#### MySQL 전체 구조
* MySQL 서버: 데이터베이스를 관리하고 데이터 가용성을 보장하는 MySQL의 기본 소프트웨어.
* MySQL 엔진:
  * 프론트, 기획자, 옵티마이제이션 및 실행계획을 세움
  * 쿼리 구문 분석, 최적화 및 실행을 담당합니다.
* 스토리지 엔진: 
  * 백엔드, 실무자, 세워진 계획을 실제로 실행
  * 데이터 저장, 검색 및 관리를 처리합니다.



#### MySQL 스레딩 구조
* 연결당 하나의 스레드 모델: MySQL이 다중 연결을 관리하는 방법.
* 스레드 풀링: 재사용 가능한 스레드 집합을 사용하여 클라이언트 연결을 효율적으로 관리합니다.
* 스레드 상태: 절전, 실행, 네트워크에서 읽기 등과 같은 다양한 상태



#### 메모리 할당 및 사용 구조
* 전역 버퍼: 예: InnoDB 버퍼 풀, 쿼리 캐시.
* 스레드별 버퍼: 예: 조인 버퍼, 정렬 버퍼.
* 메모리 저장 엔진: MEMORY/HEAP 저장 엔진.

- 메모리 공간 :
  - 글로벌 메모리 공간
    - 테이블 케시 
    - InnoDB 버퍼 풀
    - InnoDB 어댑티브 해시 인덱스
    - InnoDB 리두 로그 버퍼
  - 로컬 메모리 영역 (세선 메모리) 
    - 커넥션이 열려 있는 동안 계속 할당된 상태 (커넥션, 버퍼, 결과 버퍼)
    - 쿼리를 실행하는 순간에만 할당했다가 다시 해제하는 공간 (정렬, 조인) 
  - 로컬 메모리 영역 종류
    - 정렬 버퍼
    - 조인 버퍼 
    - 바이너리 로그 캐시
    - 네트워크 버퍼



#### 플러그인 스토리지 엔진 모델
* 플러그인 인터페이스: 커스텀 스토리지 엔진을 통합하는 방법.
* 지원되는 스토리지 엔진: 목록 및 기능.

  하나의 쿼리 작업은 여러 하위 작업으로 나뉘는데, 각 하위 작업이 MySQL 엔진 영역에서 처리되는지 아니면 스토리지 엔진 영역에서 처리되는지 구분할 줄 알아야 한다.


#### 컴포넌트
* MySQL 구성 요소: 서버, 클라이언트, 유틸리티.
* 서로 다른 구성 요소가 서로 상호 작용하는 방식.



#### 쿼리 실행 구조

<img width="925" alt="image 17" src="https://github.com/yeonseo/real-mysql/assets/6857157/8a9d730d-eb4e-4a59-991e-a1ca89cd5206">


* SQL 구문 분석: SQL 문이 구문 분석되는 방식입니다.
* 쿼리 최적화: 최상의 실행 계획을 결정합니다.
* 실행: MySQL이 실행 계획을 수행하는 방법.

옵티마이저(DBMS의 두뇌) : 사용자의 요청으로 들어온 쿼리 문장을 저렴한 비용으로 가장 빠르게 처리할지를 결정하는 역할을 담당


#### 복제
(16장에서 상세히)

####  쿼리 캐시
MySQL 8.0에서 쿼리 캐시는 서버의 기능에서 완전히 제거 됨
	데이터 변경이 거의 없는 환경에서는 훌륭한 기능이지만.,, 이런 서비스는 거의 없으므로


#### 스레드 풀
* 이점: 많은 수의 클라이언트 연결을 처리합니다.
* 연결당 스레드 1개 모델과의 차이점.


#### 트랜잭션 지원 메타 데이터
* ACID 속성: Atomicity, Consistency, Isolation, Durability.

<br><br><br><br>

### 4.2 InnoDB 스토리지 엔진 아키텍처

<img width="791" alt="image 18" src="https://github.com/yeonseo/real-mysql/assets/6857157/f1e74daf-e7c3-485b-8e19-16512fd63f3e">


InnoDB는 높은 동시성 처리가 가능하고 높은 안정성과 성능을 위해 설계된 기본 스토리지 엔진입니다.
ACID 준수, 외래 키 지원 및 행 수준 잠금과 같은 기능이 이를 구별합니다.
기본 키가 클러스터링되는 방식부터 실행 취소 로그가 작동하는 방식에 이르기까지 각 하위 주제의 복잡성을 살펴보세요.


#### 프라이머리 키에 의한 클러스터링
* 데이터 저장 방식: 클러스터링 된 방식에서 데이터가 디스크에 어떻게 저장되는지.
  * InnoDB의 모든 테이블은 기본적으로 **프라이머리** 키를 기준으로 클러스터링되어 저장된다.
  * 프라이머리 키 값의 순서대로 디스크에 저장

* 퍼포먼스 임팩트: 클러스터링된 인덱스와 일반 인덱스 사이의 조회 성능 차이. 
  * (4.3.3절 ‘데이터 파일과 프라이머리 키 구조’에서!)


